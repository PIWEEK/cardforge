(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function d(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=d(a);fetch(a.href,r)}})();let v="";function p(e){parent.postMessage(e,"*")}function I(){window.addEventListener("message",e=>{console.log("[main] received:"),console.log(e),e.data.type=="ERROR_DECK_CREATE_PAGE_NOT_EMPTY"?x(!0):e.data.type=="CARDS_DATA"?k(e.data.data):e.data.type=="CARD_FIELDS"?(v=e.data.data.assetsUrl,m=e.data.data.fields,U()):e.data.type=="IMAGE_CREATED"?D(e.data.data.num,e.data.data.name,e.data.data.id,e.data.data.imageId):e.data.type=="PAGE_EMPTY"&&(e.data.data?E("create"):E("cards"))})}const C=document.querySelectorAll(".tab-selector"),S=document.querySelectorAll(".tab");function E(e){var t,d;for(const n of C)n.classList.remove("current");(t=document.getElementById("ts-"+e))==null||t.classList.add("current");for(const n of S)n.classList.add("hidden");(d=document.getElementById("tab-"+e))==null||d.classList.remove("hidden")}function A(){for(const e of C)e.addEventListener("click",()=>{E(e.dataset.tab)})}const L=[["Dixit (80 x 120 mm)",302,454],["Tarot (70 x 120)",265,454],["French tarot (61 x 112)",231,423],["Wonder (65 x 100)",246,378],["Volcano (70 x 110)",265,416],["Euro (59 x 92)",223,348],["Asia (57,5 x 89)",217,337],["Standard (63,5 x 88)",240,333],["USA (56 x 87)",212,329],["Square L (80x80)",302,302],["Desert (50 x 75)",189,284],["Square S (70 x 70)",265,265],["Mini EURO (45 x 68)",170,257],["Mini Asia (43 x 65)",163,246],["Mini USA (41 x 63)",155,238]];function B(e){var a,r,c;e.preventDefault();let t=(a=document.getElementById("create-deck-name"))==null?void 0:a.value,d=(r=document.getElementById("create-deck-size"))==null?void 0:r.value,n=(c=document.getElementById("create-deck-orientation"))==null?void 0:c.value;p({type:"create-deck",name:t,size:d,orientation:n,data:null})}function x(e){var t,d,n,a;e?((t=document.getElementById("box-create-error"))==null||t.classList.remove("hidden"),(d=document.getElementById("box-create"))==null||d.classList.add("hidden")):((n=document.getElementById("box-create-error"))==null||n.classList.add("hidden"),(a=document.getElementById("box-create"))==null||a.classList.remove("hidden"))}function T(){let e=document.getElementById("create-deck-size");e.innerHTML="";let t;for(let d=0;d<L.length;d++)t=document.createElement("option"),t.value=""+d,t.innerText=L[d][0],e==null||e.appendChild(t);e.value=7}function O(){var e,t;(e=document.getElementById("create-deck-frm"))==null||e.addEventListener("submit",B),(t=document.getElementById("box-create-error-close"))==null||t.addEventListener("click",()=>{x(!1)}),T()}const u=document.getElementById("card-list");let m=[],s=[];function y(){p({type:"save-cards-data",data:JSON.stringify(s)})}function D(e,t,d,n){s[e-1][t]=n+"|"+d,y()}function k(e){e&&(s=JSON.parse(e),h())}function b(e,t){let d=document.createElement("div");d.classList.add("card-entry"),d.id="card-entry-"+e;let n=document.createElement("div");n.classList.add("card-actions");let a=document.createElement("div");a.classList.add("card-action-copy"),a.addEventListener("click",()=>{P(e)}),n.appendChild(a);let r=document.createElement("div");r.classList.add("card-action-delete"),r.addEventListener("click",()=>{M(e)}),n.appendChild(r);let c=document.createElement("div");c.classList.add("card-num"),c.innerText=String(e).padStart(2,"0"),d.appendChild(c);for(let o=0;o<m.length;o++)if(m[o].type=="text"){let l=document.createElement("div");l.classList.add("card-text");let i=document.createElement("input");t.hasOwnProperty(m[o].name)&&(i.value=t[m[o].name]),i.addEventListener("blur",()=>{R(e,m[o].name,i.value)}),l.appendChild(i),d.appendChild(l)}else{let l=document.createElement("div");l.classList.add("card-image");let i=document.createElement("img"),f=document.createElement("input");if(f.type="file",f.accept="image/*",l.appendChild(f),t.hasOwnProperty(m[o].name)){let g=t[m[o].name].split("|")[1];i.src=v+g}else i.src="images/add_image.png";l.appendChild(i),i.addEventListener("click",()=>{f.click()}),f.addEventListener("change",g=>{_(e,m[o].name,i,g)}),d.appendChild(l)}return d.appendChild(n),d}function w(){let e={};s.push(e);let t=b(s.length,e);u==null||u.appendChild(t),y(),u.scrollTop=u==null?void 0:u.scrollHeight}function M(e){s.splice(e-1,1),y(),h()}function P(e){let t=structuredClone(s[e-1]);s.splice(e-1,0,t),y(),h()}function R(e,t,d){s[e-1][t]=d,y()}async function _(e,t,d,n){var r;const a=n.target;if((r=a==null?void 0:a.files)!=null&&r.length){const c=a==null?void 0:a.files[0];if(c){const o=await c.arrayBuffer(),l=new Uint8Array(o),i=c.type,f=URL.createObjectURL(new Blob([l],{type:i}));d.src=f,p({type:"create-image-data",data:{data:l,mimeType:i,num:e,name:t}}),a.value=""}}}function U(){const e=document.getElementById("cards-header"),t=document.getElementById("cards-header-actions");document.querySelectorAll(".card-header").forEach(d=>d.remove());for(let d=0;d<m.length;d++){let n=m[d],a=document.createElement("div");a.classList.add("card-header"),n.type=="image"?a.classList.add("card-image"):a.classList.add("card-text"),a.innerText=n.name.substring(1),e==null||e.insertBefore(a,t)}p({type:"load-cards-data",data:""})}function h(){document.querySelectorAll(".card-entry").forEach(e=>e.remove());for(let e=0;e<s.length;e++){let t=b(e+1,s[e]);u==null||u.appendChild(t)}}function q(){p({type:"forje-cards",data:{cardsData:s}})}function F(){var e,t;p({type:"load-card-fields",data:""}),(e=document.getElementById("add-card"))==null||e.addEventListener("click",()=>{w()}),(t=document.getElementById("forge-cards"))==null||t.addEventListener("click",()=>{q()})}window.onload=e=>{I(),A(),O(),F(),p({type:"is-page-empty",data:""})};
